---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// Obtener orderId de diferentes fuentes (Mercado Pago puede enviarlo como external_reference)
const orderId = Astro.url.searchParams.get('id') || 
                Astro.url.searchParams.get('external_reference') || 
                Astro.url.searchParams.get('preference_id') || '';
const paymentStatus = Astro.url.searchParams.get('status') || 'approved';
const paymentMethod = Astro.url.searchParams.get('method') || 'mercadopago';
---

<BaseLayout>
  <Fragment slot="title">Orden Confirmada - GOTRA</Fragment>
  
  <div class="relative flex h-auto min-h-screen w-full flex-col">
    <Header />
    
    <main class="flex-grow bg-white">
      <section class="py-20">
        <div class="mx-auto max-w-2xl px-6 lg:px-12">
          <div class="text-center">
            <div class="mx-auto flex size-20 items-center justify-center mb-8">
              <span class="material-symbols-outlined text-black" style="font-size: 64px; font-weight: 300;">check_circle</span>
            </div>
            
            <span class="text-xs font-light uppercase tracking-[0.4em] text-black/60 mb-4 block">Confirmación</span>
            <h1 class="text-4xl sm:text-5xl font-light text-black tracking-[0.05em] uppercase mb-6 font-display">
              ¡Orden Confirmada!
            </h1>
            
            {paymentStatus === 'approved' ? (
              <p class="text-black/70 font-light text-sm tracking-wide mb-12 max-w-lg mx-auto leading-relaxed">
                Gracias por tu compra. Hemos recibido tu orden y te enviaremos un email de confirmación.
              </p>
            ) : paymentStatus === 'pending' ? (
              <p class="text-black/70 font-light text-sm tracking-wide mb-12 max-w-lg mx-auto leading-relaxed">
                Tu pago está siendo procesado. Te notificaremos cuando se complete.
              </p>
            ) : (
              <p class="text-red-600 font-light text-sm tracking-wide mb-12 max-w-lg mx-auto leading-relaxed">
                Hubo un problema con tu pago. Por favor, contacta con nosotros si el pago fue realizado.
              </p>
            )}
            
            {orderId && (
              <div class="border border-black/10 bg-white p-8 mb-12">
                <p class="text-xs font-light uppercase tracking-[0.2em] text-black/60 mb-2">Número de Orden</p>
                <p class="text-xl font-light text-black tracking-wide">{orderId}</p>
              </div>
            )}
            
            <div class="flex flex-col gap-4 sm:flex-row sm:justify-center">
              <a
                href="/catalogo"
                class="inline-flex h-12 items-center justify-center bg-black text-white px-10 text-xs font-light uppercase tracking-[0.2em] transition-all hover:bg-black/90"
              >
                Continuar Comprando
              </a>
              <a
                href="/"
                class="inline-flex h-12 items-center justify-center border border-black/20 text-black px-10 text-xs font-light uppercase tracking-[0.2em] transition-all hover:border-black/40"
              >
                Volver al Inicio
              </a>
            </div>
          </div>
        </div>
      </section>
    </main>
    
    <Footer />
  </div>
</BaseLayout>
